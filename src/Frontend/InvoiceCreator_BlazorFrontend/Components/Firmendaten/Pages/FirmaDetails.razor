@using InvoiceCreator_BlazorFrontend.Components.Firmendaten.Services
@using InvoiceCreator_BlazorFrontend.Components.Firmendaten.Templates
@using Shared.Domain.Models

@inject FirmaService Service
@inject NavigationManager Navigation
@inherits BasePage
@rendermode InteractiveServer

@page "/firmendaten"

@if (IsBusy)
{
    <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Lädt...</span>
    </div>
}

<Snackbar Message="@Fehlermeldung" />

@if (Firma is not null)
{
    <FirmaDetailsCard TItem="Firma"
            Firma="Firma"
            ZurueckClicked="Zurueck"
            BearbeitenClicked="Bearbeiten"
    ></FirmaDetailsCard>
}
else
{
    <p>Firma nicht gefunden.</p>
}

@code {
    
    private Firma? Firma;

    protected override async Task OnInitializedAsync()
    {
        await TryCatchAsync(async () =>
        {
            Firma = await Service.GetFirmendatenAsync();
        });
    }

    private void Zurueck() => Navigation.NavigateTo("/");
    private void Bearbeiten() => Navigation.NavigateTo($"/firma/form/{Firma.Id}");
}
