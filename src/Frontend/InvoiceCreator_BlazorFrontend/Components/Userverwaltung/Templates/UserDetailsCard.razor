@using System.Globalization
@using Shared.Domain.Models
@typeparam TItem

<div class="user-card card shadow-sm">
    <div class="card-header d-flex justify-content-between align-items-center">
        <div class="header-left d-flex align-items-center gap-2">
            <div class="avatar">@User.Initialen</div>
            <div class="header-title-wrapper">
                <h5 class="mb-0 header-title">@User.UserName</h5>
                <div class="header-sub text-white-75">@User.Rolle.ToString()</div>
            </div>
        </div>
        <span class="badge code-badge">User</span>
    </div>

    <div class="card-body">
        <div class="row gx-2 gy-2 keyvalue-grid">
            @RenderKeyValue("E-Mail", User.Email, "fas fa-envelope")
            @RenderKeyValue("Initialen", User.Initialen, "fas fa-id-badge")
            @RenderKeyValue("Rolle", User.Rolle.ToString(), "fas fa-user-shield")
            @if (User.LetzterLogin is not null)
            {
                @RenderKeyValue("Letzter Login", User.LetzterLogin.Value.ToString("g", CultureInfo.CurrentCulture), "fas fa-clock")
            }
        </div>

        <div class="separator" />

        <div class="mt-3 d-flex gap-2 justify-content-end">
            <button class="btn btn-outline-secondary btn-with-icon" @onclick="Zurueck"><i class="fas fa-arrow-left me-1"></i>Zurück</button>
            <button class="btn btn-outline-primary btn-with-icon" @onclick="Bearbeiten"><i class="fas fa-edit me-1"></i>Bearbeiten</button>
        </div>
    </div>
</div>

@code {
    [Parameter, EditorRequired]
    public required User User { get; set; }

    [Parameter]
    public EventCallback ZurueckClicked { get; set; }

    [Parameter]
    public EventCallback BearbeitenClicked { get; set; }

    RenderFragment RenderKeyValue(string label, string value, string iconClass) => @<div class="col-12 col-md-6">
        <div class="kv d-flex justify-content-between align-items-center">
            <div class="kv-left d-flex align-items-center gap-2">
                <i class="@iconClass kv-icon" aria-hidden="true"></i>
                <span class="kv-label">@label</span>
            </div>
            <div class="kv-value">@(!string.IsNullOrWhiteSpace(value) ? value : "—")</div>
        </div>
    </div>;

    Task Zurueck() => ZurueckClicked.InvokeAsync();
    Task Bearbeiten() => BearbeitenClicked.InvokeAsync();
}

